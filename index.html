<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Step By Step Game</title>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<script>
tailwind.config = {
darkMode: 'class',
theme: {
extend: { colors: { primary: '#6366f1', secondary: '#8b5cf6', accent: '#f59e0b', ice: '#00d2ff', } }
}
}
</script>
<style>
@keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
.roulette-container { position: relative; width: 100%; height: 160px; overflow: hidden; background: rgba(0,0,0,0.4); border-radius: 16px; border: 2px solid rgba(255,255,255,0.1); margin: 20px 0; }
.roulette-inner { display: flex; position: absolute; left: 0; top: 20px; transition: transform 6.5s cubic-bezier(0.15, 0, 0.15, 1); will-change: transform; }
.roulette-item { width: 120px; height: 120px; flex-shrink: 0; margin: 0 8px; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05)); border-radius: 12px; border: 1px solid rgba(255,255,255,0.1); }
.roulette-item .emoji { font-size: 3.5rem; }
.roulette-item .name { font-size: 11px; opacity: 0.8; text-align: center; margin-top: 4px; }
.roulette-pointer { position: absolute; left: 50%; top: 0; bottom: 0; width: 4px; background: #ff4757; z-index: 20; transform: translateX(-50%); box-shadow: 0 0 20px #ff4757; }
.roulette-pointer::before { content: ''; position: absolute; top: -5px; left: 50%; transform: translateX(-50%); border-left: 10px solid transparent; border-right: 10px solid transparent; border-top: 15px solid #ff4757; }
.roulette-pointer::after { content: ''; position: absolute; bottom: -5px; left: 50%; transform: translateX(-50%); border-left: 10px solid transparent; border-right: 10px solid transparent; border-bottom: 15px solid #ff4757; }
.glass { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); }
.fullscreen-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 100; overflow-y: auto; }
.ice-circle { width: 320px; height: 320px; border-radius: 50%; border: 4px solid rgba(0,210,255,0.5); position: relative; overflow: hidden; background: radial-gradient(circle, rgba(0,210,255, 0%), rgba(0,128,255,0.2) 160px, rgba(0,128,255,0.4) 100%); box-shadow: 0 0 30px rgba(0,210,255,0.3); }
.ice-ball { position: absolute; width: 40px; height: 40px; background: radial-gradient(circle at 30% 30%, #fff, #00d2ff); border-radius: 50%; box-shadow: 0 0 20px rgba(0,210,255,0.8); z-index: 10; transform: translate(-50%, -50%); border: 2px solid rgba(255,255,255,0.5); transition: left 0.025s linear, top 0.025s linear; }
.player-avatar { position: absolute; width: 40px; height: 40px; border-radius: 50%; border: 2px solid white; overflow: hidden; transform: translate(-50%, -50%); z-index: 5; transition: left 0.3s ease, top 0.3s ease; }
.case-cardboard { background: linear-gradient(135deg, #8B4513 0%, #D2691E 50%, #8B4513 100%); border: 3px solid #A0522D; }
.case-collector { background: linear-gradient(135deg, #DC143C 0%, #FF1493 50%, #8B008B 100%); border: 3px solid #FFD700; }
</style>
</head>
<body class="bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 min-h-screen text-white overflow-x-hidden">
<div id="root"></div>
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script type="text/babel">
const { useState, useEffect, useRef } = React;
const firebaseConfig = {
apiKey: "AIzaSyDZPRiByz69HQa8b7GFMCJeqq56J3Y-bOY",
authDomain: "step-by-step-279df.firebaseapp.com",
databaseURL: "https://step-by-step-279df-default-rtdb.europe-west1.firebasedatabase.app",
projectId: "step-by-step-279df",
storageBucket: "step-by-step-279df.firebasestorage.app",
messagingSenderId: "302641152597",
appId: "1:302641152597:web:6479b9ae03104666cd8adc"
};
if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const TelegramWebApp = window.Telegram?.WebApp;

const CASE_REWARDS = {
cardboard: [
{ id: 'stars_0_25', name: '0.25 ‚≠êÔ∏è', displayChance: '80%', realChance: 80, type: 'stars', value: 0.25, emoji: '‚≠êÔ∏è' },
{ id: 'stars_0_75', name: '0.75 ‚≠êÔ∏è', displayChance: '10%', realChance: 10, type: 'stars', value: 0.75, emoji: '‚≠êÔ∏è' },
{ id: 'stars_1_5', name: '1.5 ‚≠êÔ∏è', displayChance: '6%', realChance: 6, type: 'stars', value: 1.5, emoji: '‚≠êÔ∏è' },
{ id: 'stars_5', name: '5 ‚≠êÔ∏è', displayChance: '2%', realChance: 2, type: 'stars', value: 5, emoji: '‚≠êÔ∏è' },
{ id: 'bear', name: 'üß∏', displayChance: '1.5%', realChance: 1.5, type: 'item', sellPrice: 20, emoji: 'üß∏' },
{ id: 'diamond_pro', name: 'üíé PRO', displayChance: '0.5%', realChance: 0.5, type: 'collectible', emoji: 'üíé' }
],
coal: [{ id: 'stars_2_5', name: '2.5 ‚≠êÔ∏è', displayChance: '100%', realChance: 100, type: 'stars', value: 2.5, emoji: '‚≠êÔ∏è' }],
platinum: [{ id: 'stars_35', name: '35 ‚≠êÔ∏è', displayChance: '100%', realChance: 100, type: 'stars', value: 35, emoji: '‚≠êÔ∏è' }],
gold: [{ id: 'stars_50', name: '50 ‚≠êÔ∏è', displayChance: '100%', realChance: 100, type: 'stars', value: 50, emoji: '‚≠êÔ∏è' }],
money: [{ id: 'stars_150', name: '150 ‚≠êÔ∏è', displayChance: '100%', realChance: 100, type: 'stars', value: 150, emoji: '‚≠êÔ∏è' }],
elite: [{ id: 'stars_200', name: '200 ‚≠êÔ∏è', displayChance: '100%', realChance: 100, type: 'stars', value: 200, emoji: '‚≠êÔ∏è' }],
diamond: [{ id: 'stars_8', name: '8 ‚≠êÔ∏è', displayChance: '100%', realChance: 100, type: 'stars', value: 8, emoji: '‚≠êÔ∏è' }],
winter: [{ id: 'stars_20', name: '20 ‚≠êÔ∏è', displayChance: '100%', realChance: 100, type: 'stars', value: 20, emoji: '‚≠êÔ∏è' }],
major: [{ id: 'stars_500', name: '500 ‚≠êÔ∏è', displayChance: '100%', realChance: 100, type: 'stars', value: 500, emoji: '‚≠êÔ∏è' }],
collector: [
{ id: 'bear_pro', name: 'üß∏ PRO', displayChance: '55%', realChance: 55, type: 'collectible', emoji: 'üß∏' },
{ id: 'gift_pro', name: 'üéÅ PRO', displayChance: '20%', realChance: 20, type: 'collectible', emoji: 'üéÅ' },
{ id: 'rocket_pro', name: 'üöÄ PRO', displayChance: '15%', realChance: 15, type: 'collectible', emoji: 'üöÄ' },
{ id: 'cup_pro', name: 'üèÜ PRO', displayChance: '5%', realChance: 5, type: 'collectible', emoji: 'üèÜ' },
{ id: 'cake_candle', name: 'üç∞ Candle', displayChance: '2%', realChance: 2, type: 'collectible', emoji: 'üç∞' },
{ id: 'ramen_pro', name: 'üçú Ramen', displayChance: '1.5%', realChance: 0.5, type: 'collectible', emoji: 'üçú' },
{ id: 'hat_pro', name: 'üé© Hat', displayChance: '1%', realChance: 0, type: 'collectible', emoji: 'üé©' },
{ id: 'bird_pro', name: 'ü¶Ö Bird', displayChance: '0.5%', realChance: 0, type: 'collectible', emoji: 'ü¶Ö' }
]
};

const INITIAL_CASES = {
cardboard: { id: 'cardboard', name: '–ö–∞—Ä—Ç–æ–Ω', emoji: 'üì¶', price: 3, color: 'from-amber-800 to-amber-900', locked: false },
coal: { id: 'coal', name: '–£–≥–æ–ª—ë–∫', emoji: 'ü™®', price: 22, color: 'from-gray-600 to-gray-800', locked: false },
platinum: { id: 'platinum', name: '–ü–ª–∞—Ç–∏–Ω–∞', emoji: 'üíé', price: 100, color: 'from-gray-300 to-gray-500', locked: false },
gold: { id: 'gold', name: '–ó–æ–ª–æ—Ç–æ–π', emoji: 'üëë', price: 250, color: 'from-yellow-400 to-yellow-600', locked: false },
money: { id: 'money', name: '–î–µ–Ω–µ–∂–Ω—ã–π', emoji: 'üíµ', price: 350, color: 'from-green-400 to-green-600', locked: false },
elite: { id: 'elite', name: '–≠–ª–∏—Ç–∞', emoji: 'üéñ', price: 500, color: 'from-red-400 to-red-600', locked: false },
diamond: { id: 'diamond', name: '–ê–ª–º–∞–∑', emoji: 'üíé', price: 50, color: 'from-blue-400 to-blue-600', locked: false },
winter: { id: 'winter', name: '–ó–∏–º–Ω–∏–π', emoji: '‚òÉÔ∏è', price: 125, color: 'from-cyan-400 to-blue-500', locked: false },
major: { id: 'major', name: '–ú–∞–∂–æ—Ä', emoji: 'ü§¥', price: 800, color: 'from-purple-500 to-indigo-700', locked: true },
collector: { id: 'collector', name: '–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä', emoji: 'üé©', price: 650, color: 'from-rose-600 to-pink-800', locked: true }
};
    function App() {
const [currentScreen, setCurrentScreen] = useState('cases');
const [balance, setBalance] = useState(0);
const [cases, setCases] = useState(INITIAL_CASES);
const [inventory, setInventory] = useState([]);
const [inventorySlots, setInventorySlots] = useState(5);
const [tasks, setTasks] = useState({ subscribe: { completed: false }, depositMajor: { completed: false } });
const [user, setUser] = useState(null);

// Roulette
const [selectedCase, setSelectedCase] = useState(null);
const [isSpinning, setIsSpinning] = useState(false);
const [spinResult, setSpinResult] = useState(null);
const [rouletteOffset, setRouletteOffset] = useState(0);
const [fakeItems, setFakeItems] = useState([]);
const rouletteRef = useRef(null);

// Ice
const [currentGame, setCurrentGame] = useState(null);
const [iceLobby, setIceLobby] = useState(null);
const [myBet, setMyBet] = useState(25);
const [hasBet, setHasBet] = useState(false);
const [ballPos, setBallPos] = useState({ x: 50, y: 50 });
const [timerRemaining, setTimerRemaining] = useState(0);
const [showCollectibleModal, setShowCollectibleModal] = useState(false);
const [selectedCollectible, setSelectedCollectible] = useState(null);

// Admin
const [isAdmin, setIsAdmin] = useState(false);
const [adminAttempts, setAdminAttempts] = useState(0);
const [allUsers, setAllUsers] = useState([]);

useEffect(() => {
const id = localStorage.getItem('sbs_user_id') || 'u' + Date.now();
localStorage.setItem('sbs_user_id', id);
const tgUser = TelegramWebApp?.initDataUnsafe?.user;
const userData = {
id,
name: tgUser ? tgUser.first_name + (tgUser.last_name ? ' ' + tgUser.last_name : '') : '–ì–æ—Å—Ç—å',
username: tgUser?.username || '',
avatar: tgUser?.photo_url || null
};
setUser(userData);

db.ref('users/' + id).on('value', snap => {
const data = snap.val();
if (data) {
setBalance(data.balance || 0);
setInventory(data.inventory || []);
setInventorySlots(data.inventorySlots || 5);
setTasks(data.tasks || { subscribe: { completed: false } });
setCases(data.cases || INITIAL_CASES);
} else {
db.ref('users/' + id).set({ ...userData, balance: 15, cases: INITIAL_CASES });
}
});
}, []);

// –õ–û–ì–ò–ö–ê –õ–û–ë–ë–ò
const enterIceLobby = async (lId) => {
const lobbyRef = db.ref('iceLobbies/' + lId);
const snap = await lobbyRef.once('value');
const data = snap.val() || { status: 'waiting', players: {} };

if (data.status === 'playing') return alert("–ò–≥—Ä–∞ —É–∂–µ –∏–¥–µ—Ç!");

// –°—Ä–∞–∑—É —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –∏–≥—Ä–æ–∫–∞ –≤ –ª–æ–±–±–∏ (–±–µ–∑ —Å—Ç–∞–≤–∫–∏)
await lobbyRef.child('players/' + user.id).update({
id: user.id,
name: user.name,
avatar: user.avatar,
bet: 0, // –°—Ç–∞–≤–∫–∞ 0 –ø–æ–∫–∞ –Ω–µ –Ω–∞–∂–º–µ—Ç –∫–Ω–æ–ø–∫—É
color: `hsl(${Math.random() * 360}, 70%, 50%)`
});

setCurrentGame({ type: 'ice', lobbyId: lId });

// –°–ª—É—à–∞—Ç–µ–ª—å –ª–æ–±–±–∏
lobbyRef.on('value', s => {
const d = s.val();
if (d) {
setIceLobby(d);
if (d.ballPosition) setBallPos(d.ballPosition);
if (d.timerEnd) setTimerRemaining(Math.max(0, Math.ceil((d.timerEnd - Date.now())/1000)));
if (d.status === 'finished' && d.winner?.id === user.id && !d.prizeClaimed?.[user.id]) {
const win = Math.floor(d.totalPot * 0.4);
alert("–ü–û–ë–ï–î–ê! + " + win + "‚≠êÔ∏è");
db.ref('users/'+user.id+'/balance').transaction(b => (b||0) + win);
lobbyRef.child('prizeClaimed/'+user.id).set(true);
}
}
});
};

const placeIceBet = async () => {
if (balance < myBet) return alert("–ú–∞–ª–æ –∑–≤–µ–∑–¥!");
const lobbyRef = db.ref('iceLobbies/' + currentGame.lobbyId);
await db.ref('users/'+user.id+'/balance').transaction(b => b - myBet);
await lobbyRef.child('players/' + user.id).update({ bet: myBet });
setHasBet(true);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ä—Ç–∞
const snap = await lobbyRef.once('value');
const d = snap.val();
const players = Object.values(d.players || {});
const allBetted = players.length >= 2 && players.every(p => p.bet > 0);

if (allBetted && d.status === 'waiting') {
const tEnd = Date.now() + 10000;
await lobbyRef.update({ status: 'betting', timerEnd: tEnd, totalPot: players.reduce((s,p)=>s+p.bet, 0) });
setTimeout(() => startIcePhysics(lobbyRef), 10000);
}
};

const startIcePhysics = async (ref) => {
await ref.update({ status: 'playing' });
let x=50, y=50, vx=(Math.random()-0.5)*15, vy=(Math.random()-0.5)*15;
const int = setInterval(() => {
x+=vx*0.5; y+=vy*0.5;
if(x<=5||x>=95) vx*=-1; if(y<=5||y>=95) vy*=-1;
ref.child('ballPosition').set({x,y});
vx*=0.99; vy*=0.99;
if(Math.abs(vx)<0.2 && Math.abs(vy)<0.2) {
clearInterval(int);
finishIce(ref, x, y);
}
}, 30);
};

const finishIce = async (ref, fx, fy) => {
const snap = await ref.once('value');
const d = snap.val();
const players = Object.values(d.players);
const winIdx = Math.floor(Math.random() * players.length);
await ref.update({ status: 'finished', winner: players[winIdx], finalBall: {x:fx, y:fy} });
};

const leaveLobby = async () => {
const lobbyRef = db.ref('iceLobbies/' + currentGame.lobbyId);
const myData = iceLobby?.players?.[user.id];
if (myData?.bet > 0 && iceLobby.status !== 'playing') {
await db.ref('users/'+user.id+'/balance').transaction(b => (b||0) + myData.bet);
}
await lobbyRef.child('players/' + user.id).remove();
lobbyRef.off();
setCurrentGame(null);
setIceLobby(null);
};

// –†–£–õ–ï–¢–ö–ê
const openCase = async (cid) => {
const c = cases[cid];
if (user.balance < c.price) return alert("–ú–∞–ª–æ –∑–≤–µ–∑–¥!");
const balAfter = user.balance - c.price;
setBalance(balAfter);
await db.ref('users/'+user.id+'/balance').set(balAfter);

setIsSpinning(true);
setSelectedCase({...c, id: cid});
setSpinResult(null);

const pool = CASE_REWARDS[cid];
const rand = Math.random() * 100;
let cum=0, won=pool[0];
for(const i of pool){ cum+=i.realChance; if(rand<=cum){ won=i; break; } }

const tape = [];
for(let i=0; i<80; i++) tape.push(pool[Math.floor(Math.random()*pool.length)]);
tape[70] = won;
setFakeItems(tape);

setTimeout(() => {
const containerWidth = rouletteRef.current?.offsetWidth || window.innerWidth;
const itemWidth = 136; // 120 + 16 margin
const offset = (70 * itemWidth) + (itemWidth / 2) - (containerWidth / 2);
setRouletteOffset(-offset);
}, 100);

setTimeout(async () => {
setSpinResult(won);
setIsSpinning(false);
if (won.type === 'stars') {
const final = (await db.ref('users/'+user.id+'/balance').get()).val() + won.value;
db.ref('users/'+user.id+'/balance').set(final);
} else {
const inv = [...inventory, {...won, uid: Date.now()}];
db.ref('users/'+user.id+'/inventory').set(inv.slice(0, inventorySlots));
}
}, 6700);
};

const sellItem = async (it) => {
if (it.type === 'collectible') {
setSelectedCollectible(it);
setShowCollectibleModal(true);
return;
}
if (confirm("–ü—Ä–æ–¥–∞—Ç—å –∑–∞ " + it.sellPrice + "‚≠êÔ∏è?")) {
await db.ref('users/'+user.id+'/balance').transaction(b => b + it.sellPrice);
await db.ref('users/'+user.id+'/inventory').set(inventory.filter(i => i.uid !== it.uid));
}
};

if (isLoading) return <div className="h-screen flex items-center justify-center font-bold">–ó–ê–ì–†–£–ó–ö–ê...</div>;

if (currentGame?.type === 'ice') {
const pCount = iceLobby?.players ? Object.keys(iceLobby.players).length : 0;
const canBet = pCount >= 2;
return (
<div className="min-h-screen bg-slate-900 p-4 flex flex-col">
<div className="flex justify-between items-center mb-4">
<h1 className="text-xl font-bold text-ice">üßä –õ–ï–î–Ø–ù–û–ô –ö–ê–¢–û–ö</h1>
<button onClick={leaveLobby} className="bg-red-500/20 text-red-400 px-3 py-1 rounded-lg text-xs font-bold border border-red-500/50">–í–´–ô–¢–ò</button>
</div>
<div className="text-center mb-4">
<div className="text-lg font-bold">{gameStatus === 'waiting' ? '–°–ë–û–† –ò–ì–†–û–ö–û–í' : gameStatus === 'betting' ? '–°–¢–ê–†–¢ –ß–ï–†–ï–ó ' + timerRemaining : '–ò–ì–†–ê!'}</div>
<div className="text-sm opacity-60">–ò–≥—Ä–æ–∫–æ–≤: {pCount} –∏–∑ 15</div>
</div>
<div className="ice-circle mx-auto mb-6">
{iceLobby?.players && Object.values(iceLobby.players).map((p, i) => (
<div key={p.id} className="player-avatar" style={{ left: `${50 + 35 * Math.cos(i * 2 * Math.PI / pCount + 1.5)}%`, top: `${50 + 35 * Math.sin(i * 2 * Math.PI / pCount + 1.5)}%`, borderColor: p.color }}>
{p.avatar ? <img src={p.avatar} className="w-full h-full object-cover" /> : <div className="w-full h-full bg-slate-700 flex items-center justify-center">{p.name[0]}</div>}
</div>
))}
{gameStatus === 'playing' && <div className="ice-ball" style={{ left: ballPos.x + '%', top: ballPos.y + '%' }} />}
</div>
{!hasBet ? (
<div className={`p-4 rounded-2xl ${canBet ? 'glass' : 'bg-slate-800 opacity-50'} transition-all`}>
{!canBet && <div className="text-center text-xs text-yellow-400 mb-2 font-bold animate-pulse">–û–ñ–ò–î–ê–ï–ú –°–û–ü–ï–†–ù–ò–ö–ê (–°–ï–ô–ß–ê–° {pCount})</div>}
<input type="number" value={myBet} disabled={!canBet} onChange={e=>setMyBet(+e.target.value)} className="w-full bg-black/40 p-3 rounded-xl text-center text-xl mb-3 outline-none" />
<button onClick={placeIceBet} disabled={!canBet || balance < myBet} className="w-full bg-ice text-slate-900 font-black py-3 rounded-xl shadow-lg shadow-ice/20">–°–î–ï–õ–ê–¢–¨ –°–¢–ê–í–ö–£</button>
</div>
) : <div className="text-center text-green-400 font-bold py-4">–°–¢–ê–í–ö–ê –ü–†–ò–ù–Ø–¢–ê. –û–ñ–ò–î–ê–ù–ò–ï...</div>}
<div className="mt-auto pt-4 flex flex-wrap justify-center gap-2 opacity-40 grayscale scale-75">
{['üß∏','üß§','‚ùÑÔ∏è','üêï','‚òÉÔ∏è','üéñ','‚≠êÔ∏è'].map(e => <span key={e} className="text-2xl glass p-2 rounded-lg">{e}</span>)}
</div>
</div>
);
}

return (
<div className="min-h-screen flex flex-col pb-20">
<header className="p-4 flex justify-between items-center glass sticky top-0 z-50">
<h1 onClick={()=>{ setAdminAttempts(a=>a+1); if(adminAttempts>=10) setIsAdmin(true); }} className="font-black tracking-tighter text-xl">STEP BY STEP</h1>
<div className="bg-yellow-500 text-slate-900 px-4 py-1 rounded-full font-black shadow-lg">{balance.toFixed(2)} ‚≠êÔ∏è</div>
</header>

<main className="p-4 flex-1">
{currentScreen === 'cases' && (
<div className="grid grid-cols-2 gap-3">
{Object.values(cases).map(c => {
const locked = (c.id === 'collector' && totalDeposits < 350);
return (
<div key={c.id} onClick={() => !locked && openCase(c.id)} className={`p-4 rounded-2xl flex flex-col items-center glass transition active:scale-95 ${c.cls} ${locked ? 'opacity-40 grayscale' : ''}`}>
<div className="text-5xl mb-2">{c.emoji}</div>
<div className="font-bold text-[10px] uppercase tracking-widest">{c.name}</div>
<div className="text-[10px] mt-1 opacity-60">{locked ? 'üîí 350‚≠êÔ∏è' : c.price + ' ‚≠êÔ∏è'}</div>
</div>
);
})}
</div>
)}

{currentScreen === 'games' && (
<div onClick={() => enterIceLobby(1)} className="p-8 rounded-3xl glass border-2 border-ice/30 text-center cursor-pointer active:scale-95 transition">
<div className="text-7xl mb-4">‚òÉÔ∏è</div>
<h2 className="text-2xl font-bold text-ice uppercase tracking-tighter">–õ–µ–¥—è–Ω–æ–π –ö–∞—Ç–æ–∫</h2>
<div className="mt-4 bg-ice/10 py-2 rounded-full text-ice text-xs font-bold uppercase">–í–æ–π—Ç–∏ –≤ –ª–æ–±–±–∏ #1</div>
</div>
)}

{currentScreen === 'profile' && (
<div className="space-y-4">
<div className="glass p-6 rounded-3xl text-center">
<div className="w-20 h-20 bg-ice/20 mx-auto rounded-full mb-3 flex items-center justify-center text-3xl overflow-hidden border-2 border-white/20">
{user.avatar ? <img src={user.avatar} className="w-full h-full object-cover" /> : user.name[0]}
</div>
<div className="font-bold">{user.name}</div>
</div>
<div className="glass p-4 rounded-3xl">
<div className="flex justify-between mb-2 text-xs font-bold opacity-50 uppercase tracking-widest"><span>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</span><span>{inventory.length}/{inventorySlots}</span></div>
<div className="grid grid-cols-4 gap-2 mb-4">
{[...Array(inventorySlots)].map((_, i) => (
<div key={i} onClick={() => inventory[i] && sellItem(inventory[i])} className="aspect-square bg-white/5 rounded-xl border border-white/10 flex items-center justify-center text-2xl">
{inventory[i]?.emoji}
</div>
))}
</div>
<button onClick={() => balance >= 50 && db.ref('users/'+user.id).update({ balance: balance-50, inventorySlots: inventorySlots+1 })} className="w-full py-2 bg-slate-800 rounded-xl text-[10px] font-bold uppercase tracking-widest">+ –°–ª–æ—Ç (50‚≠êÔ∏è)</button>
</div>
</div>
)}
</main>

{selectedCase && (
<div className="overlay modal fullscreen-modal">
<div className="w-full max-w-md p-4" ref={rouletteRef}>
<div className="text-center text-3xl font-black mb-10 text-yellow-400 tracking-tighter uppercase">{isSpinning ? '–£–î–ê–ß–ò!' : spinResult?.name}</div>
<div className="roulette-container" key={rouletteKey}>
<div className="roulette-pointer"></div>
<div className="roulette-inner" style={{ transform: `translateX(${rouletteOffset}px)` }}>
{fakeItems.map((it, i) => <div key={i} className="roulette-item"><div className="emoji">{it.emoji}</div></div>)}
</div>
</div>
{!isSpinning && spinResult && <button onClick={() => setSelectedCase(null)} className="w-full py-4 bg-green-500 rounded-2xl font-black text-xl shadow-xl shadow-green-500/20 active:scale-95 transition mt-6">–ó–ê–ë–†–ê–¢–¨</button>}
</div>
</div>
)}

{showCollectibleModal && (
<div className="overlay modal fullscreen-modal">
<div className="glass p-8 rounded-[40px] text-center max-w-xs border-2 border-ice/50 shadow-2xl">
<div className="text-7xl mb-6 animate-bounce">{selectedCollectible?.emoji}</div>
<h3 className="text-xl font-black mb-4 uppercase">–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç!</h3>
<p className="text-sm opacity-70 leading-relaxed mb-8">–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–≥—Ä–∞–¥—ã –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ <a href="https://t.me/stepbystepdelision" target="_blank" className="text-ice font-bold underline decoration-ice/30">–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏</a>.</p>
<button onClick={() => setShowCollectibleModal(false)} className="w-full py-4 bg-ice text-slate-900 rounded-2xl font-black uppercase tracking-widest transition active:scale-95">–ó–∞–∫—Ä—ã—Ç—å</button>
</div>
</div>
)}

<nav className="fixed bottom-0 left-0 right-0 glass p-3 flex justify-around rounded-t-3xl border-t border-white/10 z-50">
{['tasks', 'cases', 'games', 'profile'].map(s => (
<button key={s} onClick={() => setCurrentScreen(s)} className={`nav-btn ${currentScreen === s ? 'active' : ''}`}>
<span className="text-2xl">{s==='cases'?'üé∞':s==='games'?'üéÆ':s==='profile'?'üë§':'üìã'}</span>
<span className="uppercase">{s === 'tasks' ? '–ó–∞–¥–∞–Ω–∏—è' : s === 'profile' ? '–ü—Ä–æ—Ñ–∏–ª—å' : s === 'cases' ? '–ö–µ–π—Å—ã' : '–ò–≥—Ä—ã'}</span>
</button>
))}
</nav>
</div>
);
}
ReactDOM.createRoot(document.getElementById('root')).render(<App />);
</script>
</body>
</html>
